CMAKE_MINIMUM_REQUIRED(VERSION 3.10)
PROJECT(breeze_deploy LANGUAGES C CXX VERSION 0.0.1)

set(CMAKE_CXX_STANDARD 11)

include(cmake/opencv.cmake)
include(cmake/onnxruntime.cmake)
include(cmake/eigen.cmake)
include(cmake/spdlog.cmake)
include(cmake/yaml_cpp.cmake)

INCLUDE_DIRECTORIES(${OPENCV_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${ONNX_RUNTIME_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${EIGEN3_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${SPDLOG_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${YAML_CPP_INCLUDE_DIR})

set(BREEZE_DEPLOY_SOURCE_DIRECTORY ${PROJECT_SOURCE_DIR}/breeze_deploy)
INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR})
file(GLOB_RECURSE BREEZE_DEPLOY_HEADS ${BREEZE_DEPLOY_SOURCE_DIRECTORY}/*.h)
file(GLOB_RECURSE BREEZE_DEPLOY_SOURCES ${BREEZE_DEPLOY_SOURCE_DIRECTORY}/*.cpp)
add_library(${CMAKE_PROJECT_NAME} SHARED ${BREEZE_DEPLOY_SOURCES})
target_link_libraries(${CMAKE_PROJECT_NAME} PUBLIC ${OPENCV_LIBRARIES} ${ONNX_RUNTIME_LIBRARIES} ${YAMLCPP_LIBRARIES})

add_subdirectory(test)

install(TARGETS ${CMAKE_PROJECT_NAME} DESTINATION bin)